import requests
from bs4 import BeautifulSoup
import scraperwiki
from datetime import datetime
import pytz
req = requests.get('http://www.shunon.com.hk/pricing.php')
soup = BeautifulSoup(req.content, 'html.parser')
table = soup.find_all('table', {'class': 'Font16Boldc'})[1]
element = table.find_all('p')[0]
text = element.text.split()
titles = [text[i] for i in (0, 2, 4, 6)]
values = [int(text[i].replace('$', '').replace(',', ''))
                  for i in (1, 3, 5, 7)]
hkt = pytz.timezone('Asia/Hong_Kong')
dt = datetime.now().replace(tzinfo=hkt).date()
data = {titles[i]: values[i] for i in range(0, 4)}
data['date'] = dt
data={u'Gentiloni Silveri-I': {'start_date': '2016-12-12', '9': {'start_date': '2016-12-12', 'role': u'Giustizia', 'senato_identifier': '23029', 'birth_date': '1969-02-08', 'given_name': u'Andrea', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'La Spezia', 'family_name': u'ORLANDO', 'image': '', 'gender': 'M', 'profession': ''}, '2': {'start_date': '2016-12-12', 'role': u'Ministro senza portafoglio per i rapporti con il Parlamento', 'senato_identifier': '991', 'birth_date': '1955-03-31', 'given_name': u'Anna', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Modica (Ragusa)', 'family_name': u'FINOCCHIARO', 'image': 'http://www.senato.it/leg/17/Immagini/Senatori/00000991.jpg', 'gender': 'F', 'profession': u'Magistrato'}, '3': {'start_date': '2016-12-12', 'role': u'Ministro senza portafoglio per la semplificazione e la pubblica amministrazione', 'senato_identifier': '25472', 'birth_date': '1980-09-05', 'given_name': u'Maria Anna', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Roma', 'family_name': u'MADIA', 'image': '', 'gender': 'F', 'profession': ''}, '1': {'start_date': '2016-12-12', 'role': u'Presidente del Consiglio dei ministri', 'senato_identifier': '17988', 'birth_date': '1954-11-22', 'given_name': u'Paolo', 'end_date': '', 'death_date': '', 'label': 'Presidente del Consiglio dei ministri', 'birth_location': u'Roma', 'family_name': u'GENTILONI SILVERI', 'image': '', 'gender': 'M', 'profession': ''}, '6': {'start_date': '2016-12-12', 'role': u'Ministro senza portafoglio per lo sport', 'senato_identifier': '29461', 'birth_date': '1982-06-20', 'given_name': u'Luca', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'EMPOLI (Firenze)', 'family_name': u'LOTTI', 'image': '', 'gender': 'M', 'profession': ''}, '7': {'start_date': '2016-12-12', 'role': u'Affari esteri e coop. inter.le', 'senato_identifier': '17671', 'birth_date': '1970-10-31', 'given_name': u'Angelino', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Agrigento', 'family_name': u'ALFANO', 'image': '', 'gender': 'M', 'profession': ''}, '4': {'start_date': '2016-12-12', 'role': u'Ministro senza portafoglio per gli affari regionali', 'senato_identifier': '22911', 'birth_date': '1969-11-29', 'given_name': u'Enrico', 'end_date': '2017-07-20', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Cuneo', 'family_name': u'COSTA', 'image': '', 'gender': 'M', 'profession': ''}, '5': {'start_date': '2016-12-12', 'role': u'Ministro senza portafoglio per la coesione territoriale e il Mezzogiorno', 'senato_identifier': '28576', 'birth_date': '1948-10-28', 'given_name': u'Claudio', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': '', 'family_name': u'DE VINCENTI', 'image': '', 'gender': 'M', 'profession': ''}, '20': {'start_date': '2016-12-12', 'role': u'Salute', 'senato_identifier': '25474', 'birth_date': '1971-10-14', 'given_name': u'Beatrice', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Roma', 'family_name': u'LORENZIN', 'image': '', 'gender': 'F', 'profession': ''}, 'end_date': '', 'legislatura': '17', '18': {'start_date': '2016-12-12', 'role': u'Istruzione, universit\xe0 e ricerca', 'senato_identifier': '26041', 'birth_date': '1949-07-29', 'given_name': u'Valeria', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Treviglio (Bergamo)', 'family_name': u'FEDELI', 'image': 'http://www.senato.it/leg/17/Immagini/Senatori/00026041.jpg', 'gender': 'F', 'profession': u'Sindacalista'}, '19': {'start_date': '2016-12-12', 'role': u'Beni e attivit\xe0 culturali e turismo', 'senato_identifier': '5799', 'birth_date': '1958-10-19', 'given_name': u'Dario', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Ferrara', 'family_name': u'FRANCESCHINI', 'image': '', 'gender': 'M', 'profession': ''}, '12': {'start_date': '2016-12-12', 'role': u'Sviluppo economico', 'senato_identifier': '30110', 'birth_date': '', 'given_name': u'Carlo', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': '', 'family_name': u'CALENDA', 'image': '', 'gender': '', 'profession': ''}, '13': {'start_date': '2016-12-12', 'role': u'Infrastrutture e trasporti', 'senato_identifier': '28670', 'birth_date': '1960-04-27', 'given_name': u'Graziano', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u"Reggio nell'Emilia", 'family_name': u'DELRIO', 'image': '', 'gender': 'M', 'profession': ''}, '10': {'start_date': '2016-12-12', 'role': u'Difesa', 'senato_identifier': '17750', 'birth_date': '1961-05-20', 'given_name': u'Roberta', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Genova', 'family_name': u'PINOTTI', 'image': 'http://www.senato.it/leg/17/Immagini/Senatori/00017750.jpg', 'gender': 'F', 'profession': u'Insegnante'}, '11': {'start_date': '2016-12-12', 'role': u'Economia e finanze', 'senato_identifier': '30744', 'birth_date': '1950-01-19', 'given_name': u'Pietro Carlo', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': '', 'family_name': u'PADOAN', 'image': '', 'gender': 'M', 'profession': ''}, '16': {'start_date': '2016-12-12', 'role': u'Ambiente e tutela del territorio e del mare', 'senato_identifier': '22961', 'birth_date': '1961-07-15', 'given_name': u'Gian Luca', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Bologna', 'family_name': u'GALLETTI', 'image': '', 'gender': 'M', 'profession': ''}, '17': {'start_date': '2016-12-12', 'role': u'Lavoro e politiche sociali', 'senato_identifier': '30743', 'birth_date': '1951-11-19', 'given_name': u'Giuliano', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Imola (Bologna)', 'family_name': u'POLETTI', 'image': '', 'gender': 'M', 'profession': ''}, '14': {'start_date': '2018-03-14', 'role': u'Politiche agricole alimentari e forestali', 'senato_identifier': '17988', 'birth_date': '1954-11-22', 'given_name': u'Paolo', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Roma', 'family_name': u'GENTILONI SILVERI', 'image': '', 'gender': 'M', 'profession': ''}, '15': {'start_date': '2016-12-12', 'role': u'Politiche agricole alimentari e forestali', 'senato_identifier': '30112', 'birth_date': '1978-09-09', 'given_name': u'Maurizio', 'end_date': '2018-03-14', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Calcinate (Bergamo)', 'family_name': u'MARTINA', 'image': '', 'gender': 'M', 'profession': ''}, '8': {'start_date': '2016-12-12', 'role': u'Interno', 'senato_identifier': '12379', 'birth_date': '1956-06-06', 'given_name': u'Marco', 'end_date': '', 'death_date': '', 'label': 'Ministro', 'birth_location': u'Reggio Di Calabria', 'family_name': u'MINNITI', 'image': 'http://www.senato.it/leg/17/Immagini/Senatori/00012379.jpg', 'gender': 'M', 'profession': u'Funzionario di partito'}}, 'id': '20180408'}
scraperwiki.sqlite.save(unique_keys=['id'], data=data)
